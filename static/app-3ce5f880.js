"use strict";function runningInProd(){return window.location.hostname.endsWith("hdontap.com")}function getStream(e,t){if(runningInProd()){var a=new window.XMLHttpRequest;a.onreadystatechange=function(){4===a.readyState&&t(200===a.status?JSON.parse(atob(a.responseText)):{error:!0,errorMessage:a.statusText})},a.onerror=function(){console.log("Unknown error fetching data "+a.statusText)};var r=window.location.ancestorOrigins&&window.location.ancestorOrigins.length&&window.location.ancestorOrigins.item(0),o=r||document.referrer||window.location.href;a.open("GET","/backend/embed/"+e+"?r="+btoa(o),!0),a.setRequestHeader("Content-type","application/x-www-form-urlencoded"),a.send()}else t({streamSrc:"https://edge02.nginx.hdontap.com/ho4/ngrp:aef-nefl-4k_fixed-cam.stream_all/playlist.m3u8",autoStart:!0,hiddenVolume:!0,audioMute:!0,abs:!0,sponsored:!0,sponsoredFadeAfter:5,sponsoredPosition:4,sharing:{sharingUrl:"https://hdontap.com/hello.html",handle:"hdontap",text:"Check out this stream!",hashtags:"live,stream"},timelapses:[{src:"https://timelapse.hdontap.com/internal/storage/2018-08-13/27/67/2/movies/120-1280x720-3584k-15-1534125600000000000-1534134300000000000-archive:30-protect:false-remove:false.mp4",preset:"Beach",label:"2018-08-13"},{src:"https://timelapse.hdontap.com/internal/storage/2018-08-13/27/52/1/movies/121-1280x720-3584k-10-1534082400000000000-1534128900000000000-archive:30-protect:false-remove:false.mp4",preset:"Flag",label:"2018-08-13"},{src:"https://timelapse.hdontap.com/internal/storage/2018-08-12/27/52/2/movies/122-1280x720-3584k-10-1533996000000000000-1534042500000000000-archive:30-protect:false-remove:false.mp4",preset:"Beach",label:"2018-08-12"},{src:"https://timelapse.hdontap.com/internal/storage/2018-08-12/27/52/1/movies/121-1280x720-3584k-10-1533996000000000000-1534042500000000000-archive:30-protect:false-remove:false.mp4",preset:"Flag",label:"2018-08-12"}],previewImg:"https://stage.hdontap.com/snapshot/JDO-AxisP5534-1-HDOT",overlay:{image:"https://stage.hdontap.com/backend/files/upload_082e56f04cd675516bc9793dc5cfceb1.png",margin:0,maxWidth:200,offsetX:20,offsetY:10,opacity:100,position:4,responsive:!1,type:"responsive",url:"https://hdontap.com/cams",xSize:25},discovery:{title:"Discover other cams",overrideSponsored:!0,thumbnails:[{img:"https://portal.hdontap.com/snapshot/aef-nefl-4k_fixed-cam-CUST-ROKU",url:"https://hdontap.com",title:"Nest Cam"},{img:"https://portal.hdontap.com/snapshot/hdontap_carlsbad_terra-mar-pt-HDOT-ROKU",url:"https://hdontap.com",title:"carlsbad terra"},{img:"https://portal.hdontap.com/snapshot/carbontv_crush-deer-HDOT-carousel",url:"https://hdontap.com",title:"Deer Cam"},{img:"https://portal.hdontap.com/snapshot/aef-nefl-4k_fixed-cam-CUST-ROKU",url:"https://hdontap.com",title:"Nest Cam"},{img:"https://portal.hdontap.com/snapshot/hdontap_carlsbad_terra-mar-pt-HDOT-ROKU",url:"https://hdontap.com",title:"carlsbad terra"},{img:"https://portal.hdontap.com/snapshot/carbontv_crush-deer-HDOT-carousel",url:"https://hdontap.com",title:"Deer Cam"},{img:"https://portal.hdontap.com/snapshot/hdontap_carlsbad_terra-mar-pt-HDOT-ROKU",url:"https://hdontap.com",title:"carlsbad terra"},{img:"https://portal.hdontap.com/snapshot/carbontv_crush-deer-HDOT-carousel",url:"https://hdontap.com",title:"Deer Cam"}]},previews:[{img:"https://portal.hdontap.com/snapshot/aef-nefl-4k_fixed-cam-CUST-ROKU",url:"https://edge02.nginx.hdontap.com/ho4/ngrp:aef-nefl-4k_fixed-cam.stream_all/playlist.m3u8",abs:!0},{img:"https://portal.hdontap.com/snapshot/hdontap_carlsbad_terra-mar-pt-HDOT-ROKU",url:"https://edge02.nginx.hdontap.com/ho4/hdontap_carlsbad_terra-mar-pt.stream/playlist.m3u8",abs:!0},{img:"https://portal.hdontap.com/snapshot/carbontv_crush-deer-HDOT-carousel",url:"https://edge02.nginx.hdontap.com/ho4/ngrp:carbontv_crush-deer.stream_all/playlist.m3u8",abs:!0},{img:"https://portal.hdontap.com/snapshot/aef-nefl-4k_fixed-cam-CUST-ROKU",url:"https://edge02.nginx.hdontap.com/ho4/ngrp:aef-nefl-4k_fixed-cam.stream_all/playlist.m3u8",abs:!0},{img:"https://portal.hdontap.com/snapshot/hdontap_carlsbad_terra-mar-pt-HDOT-ROKU",url:"https://edge02.nginx.hdontap.com/ho4/hdontap_carlsbad_terra-mar-pt.stream/playlist.m3u8",abs:!0},{img:"https://portal.hdontap.com/snapshot/carbontv_crush-deer-HDOT-carousel",url:"https://edge02.nginx.hdontap.com/ho4/ngrp:carbontv_crush-deer.stream_all/playlist.m3u8",abs:!0}],weatherWidget:{currently:{summary:"Partly Cloudy",icon:"partly-cloudy-night",temperature:67.89,windSpeed:.38,humidity:.85},fadeAfter:20,label:"Weather Information",latitude:32.970085,longitude:-117.264765,offset:-7,opacity:50,position:2,time:1534252349,timezone:"America/Los_Angeles",units:"f"},streamTimeout:{delay:40,imageUrl:"http://portal.hdontap.test/backend/files/upload_502bf58532d06913a6dce859eebb7b01.png",action:"resume",redirectTo:"http://www.ggogle.com",stillWatching:!0}})}function showError(e){embedVideoEl.style.display="none",spinnerEl.style.display="none";var t=document.createElement("h2");t.innerHTML=e.split("\n").map(function(e){return"<p>"+e+"</p>"}).join("");var a=document.createElement("img");a.setAttribute("src","assets/images/logo_hdontap2.png");var r=document.createElement("a");r.setAttribute("href","//hdontap.com"),r.setAttribute("title","HDOnTap - Live Webcam Streaming Solutions"),r.setAttribute("target","_blank"),r.appendChild(a);var o=document.createElement("div");o.appendChild(r),o.appendChild(t),error.appendChild(o),error.style.display="flex"}function showBlockedImg(e,t){var a=document.createElement("img"),r=document.createElement("a");r.setAttribute("href",t),r.setAttribute("target","_blank"),a.setAttribute("src",e),a.setAttribute("height","100%"),a.classList.add("blocked-img"),r.appendChild(a),error.appendChild(r),error.style.display="flex"}function showOfflineFallbackImg(e){var t=document.createElement("img");t.setAttribute("src",e),t.setAttribute("width","100%"),error.appendChild(t),error.style.display="flex"}function overlayImageElement(e){var t=document.createElement("img"),a=document.createElement("a");return e.opacity=e.opacity||100,e.maxWidth=e.maxWidth||200,t.onload=function(){if(e.responsive){var t=e.xSize||25;this.style.width=t+"%"}this.style["max-width"]=e.maxWidth+"px"},t.src=e.image,a.style.opacity=e.opacity/100,a.appendChild(t),e.url&&(a.href=e.url,a.target="_blank"),a}function brandingElement(e){var t=document.createElement("a"),a=document.createElement("img"),r=document.createElement("span");t.id="sponsored-player-overlay",r.innerText=e.text;var o=new Image;return o.src="./assets/images/cloudmark-white.svg",o.onload=function(){a.src=this.src},e.callback?(t.style.cursor="pointer",t.addEventListener("click",e.callback)):(t.target="_blank",t.href=e.target),t.appendChild(a),t.appendChild(r),e.fade&&setTimeout(function(){t.parentNode.classList.add("fadeout")},1e3*e.fade),t}function overlayPosString(e){switch(e){case 1:return"top-left";case 2:return"top-right";case 3:return"bottom-left";default:return"bottom-right"}}function setupAds(e,t){var a={adPlaying:!1,midrolls:Array.isArray(t.midrollUrl)?t.midrollUrl:[t.midrollUrl],prerollPlayed:!1,midrollPlayed:!1};e.ads({debug:!0,timeout:2e3,prerollTimeout:100}),e.on("readyforpreroll",function(){return a.prerollPlayed?void console.log("Preroll already played, skip"):(a.adPlaying=!0,a.prerollPlayed=!0,e.one("aderror",function(){e.trigger("adserror")}),e.ads.startLinearAdMode(),e.src(t.prerollUrl),e.trigger("adplaying"),e.trigger("ads-ad-started"),void e.one("adended",function(){a.adPlaying=!1,e.ads.endLinearAdMode()}))}),e.trigger("adsready")}function initPlayer(e){var t="We have experienced a technical issue while trying to play the stream. Reloading the page may fix the issue, otherwise we'll take care of it as fast as we can.";try{window.top.location.hostname&&(e.streamSrc=e.streamSrc.replace(/^http:\/\//,"https://"))}catch(a){}console.log(e);var r={src:e.streamSrc,type:"application/x-mpegURL"},o="16:9";try{videojs.options.hls.overrideNative=!0}catch(a){console.log(a)}var n={preload:"auto",aspectRatio:e.ratio||o,fluid:e.fluid,autoplay:e.autoStart,techOrder:["html5"],muted:e.audioMute,poster:e.previewImg,sources:[r],overrideNative:!0,html5:{nativeTextTracks:!1,nativeAudioTracks:!1,nativeVideoTracks:!1,hls:{overrideNative:!0,enableLowInitialPlaylist:!0}},hls:{overrideNative:!0,enableLowInitialPlaylist:!0},controlBar:{durationDisplay:!1,currentTimeDisplay:!1,timeDivider:!1,audioTrackButton:!1,subsCapsButton:!1,captionsButton:!1,textTrackSettings:!1,volumePanel:!e.hiddenVolume},notSupportedMessage:e.userErrorMsg||t},s=videojs("embed-video-el",n),i=e.weatherWidget,l=e.previews,d=e.discovery,p=e.toolbarLogo;if(p&&p.enabled&&s.toolbarLogo({href:p.targetURL,src:"assets/images/HDonTap(WhiteTranslucent).svg",alt:"HDOnTap Logo"}),e.abs&&s.quality(),i&&!i.error){addWeatherIconFont();var c=transformWeatherConfig(i);s.weather(c)}l&&s.preview({label:"Other views!",previews:l}),d&&d.thumbnails&&d.thumbnails.length&&s.discovery({controlBarTitle:d.title,thumbnails:d.thumbnails.sort(sortByOrder)});var m,h=[],u=e.overlay;if(u){var g=[];m=overlayPosString(u.position),u.responsive&&g.push("hdontap-responsive-overlay");var f=u.offsetX,y=u.offsetY;if(f||y){var v=[],b=m.split("-");if(f&&v.push(b[1]+": "+f+"%"),y){var w=s.el().offsetHeight,x=getComputedHeight(s.controlBar.el());y=w/100*y+x,v.push(b[0]+": "+Math.floor(y)+"px")}g.push("hdontap-overlay-offsets");var T=".vjs-overlay.hdontap-overlay-offsets.vjs-overlay-"+m,k=T+" { "+v.join("; ")+" }";addStylesToEmbed(k)}h.push({content:overlayImageElement(e.overlay),align:m,start:"play","class":g.join(" ")})}if(e.sponsored){var S={target:e.sponsoredUrl||"//hdontap.com/cams",text:"More Cams",fade:e.sponsoredFadeAfter},E=e.sponsoredPosition||1;if(u||i){var _=u&&u.position,O=i&&i.position;E!==_&&E!==O||(E=[1,2,3,4].filter(function(e){return e!==_&&e!==O})[0])}d&&d.overrideSponsored&&(S.callback=function(){var e=document.querySelector(".vjs-discovery__toggle");e.click()}),h.push({align:overlayPosString(E),start:"play",content:brandingElement(S),"class":"vjs-branding-btn"})}h.length&&s.overlay({debug:!0,attachToControlBar:!0,showBackground:!1,overlays:h});var C=!!e.streamSrc.match(/\?DVR/);C&&s.dvr();var P=e.timelapses;P&&!C&&(P.reverse(),s.goLive({streamType:"application/x-mpegURL",streamSrc:e.streamSrc,onLive:initTimelapsePlugins.bind(null,s,P)}),initTimelapsePlugins(s,P)),e.ads&&e.ads.enablePreroll&&(console.log("Setup ads..."),setupAds(s,e.ads)),s.ready(function(){if(e.audioMute&&(this.volume(0),this.controlBar.volumePanel&&this.controlBar.volumePanel.hide()),e.autoStart&&this.play(),e.sharing){var t={shareUrl:e.sharing.sharingUrl||"https://hdontap.com",handle:e.sharing.handle||"HDOnTap",shareText:e.sharing.text||"Check out this stream",hashtags:e.sharing.hashtags};this.socialShare({facebook:t,twitter:t})}e.streamTimeout&&this.streamTimeout(e.streamTimeout)})}function initTimelapsePlugins(e,t){if(t[0].preset){var a=t.map(function(e){return e.preset}).filter(function(e,t,a){return a.indexOf(e)===t}),r=function(a){var r=t.filter(function(e){return e.preset===a});e.timelapse({sources:r,icon:"calendar",type:"video/mp4",title:"label",src:"src",toSelect:"Day",autoPlay:!0,showLiveIndicator:!1})};e.timelapse({destroy:!0}),e.presets({presets:a,onChange:r})}else e.timelapse({sources:t,type:"video/mp4",title:"label",src:"src",toSelect:"Timelapse",autoPlay:!1,showLiveIndicator:!0})}function getComputedHeight(e){return parseInt(window.getComputedStyle(e).height)}function addStylesToEmbed(e){var t=document.querySelector("style");t.appendChild(document.createTextNode(e))}function transformWeatherConfig(e){if(!e||0===Object.keys(e).length)return{};var t=e.currently,a=new Date,r={hour:"numeric",minute:"numeric",hour12:!0},o={weekday:"short",month:"short",day:"numeric"};r.timeZone=e.timezone;var n=a.toLocaleString("en-US",r).split(" "),s=a.toLocaleString("en-US",o),i={temp:Math.round(t.temperature),humidity:Math.round(100*t.humidity),icon:t.icon,summary:t.summary,label:e.label,fadeAfter:e.fadeAfter,opacity:e.opacity,position:overlayPosString(e.position),units:e.units,wind:t.windSpeed,date:s,time:n[0],ampm:n[1]};return i}function addWeatherIconFont(){var e=document.createElement("link");e.rel="stylesheet",e.href="./assets/fonts/weather-icons/weather-icons.min.css",document.head.appendChild(e)}function sortByOrder(e,t){return e.order<t.order?-1:e.order>t.order?1:0}function showIEwarning(){var e=document.getElementById("ie-warning"),t=document.getElementById("player-container");t.style.display="none",spinnerEl.style.display="none",e.style.display="block"}var embedVideoEl=document.getElementById("embed-video-el"),spinnerEl=document.getElementById("spinner"),error=document.getElementById("error"),ua=navigator.userAgent,isIE=ua.indexOf("MSIE ")>-1||ua.indexOf("Trident/")>-1,getParameterByName=function(e){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var t=new RegExp("[\\?&]"+e+"=([^&#]*)"),a=t.exec(window.location.search);return null===a?"":decodeURIComponent(a[1].replace(/\+/g," "))},streamName=getParameterByName("stream"),ratio=getParameterByName("ratio"),fluid=getParameterByName("fluid");isIE?showIEwarning():streamName?getStream(streamName,function(e){var t="No Load Balanced servers available";spinnerEl.style.display="none",e.error?e.blockedImgUrl?showBlockedImg(e.blockedImgUrl,e.blockedUrl):e.errorImgURL?showOfflineFallbackImg(e.errorImgURL):showError(e.errorMessage||"Error occurred"):e.streamSrc.match(t)?showError(t):(embedVideoEl.style.display="block",e.ratio=ratio,e.fluid="true"==fluid,initPlayer(e))}):showError("Stream is not found");